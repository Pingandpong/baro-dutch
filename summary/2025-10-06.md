# 2025년 10월 6일 월요일

## 오늘 한 일

1.  **TDS 설치 및 의존성 충돌 발생**:
    *   `@toss/tds-mobile` 등 TDS 관련 패키지 설치를 시도했으나, `react` 버전(`18.2.0` vs `18.3.1`) 차이로 인해 `ERESOLVE` 의존성 충돌 에러가 발생했습니다.

2.  **의존성 연쇄 업데이트 및 문제 해결**:
    *   **1단계 (React 버전 조정):** `package.json`에서 `react`와 `react-dom` 버전을 `18.3.1`로 상향 조정했으나, `@apps-in-toss/analytics` 패키지와의 충돌이 계속되었습니다.
    *   **2단계 (프레임워크 업데이트):** `@apps-in-toss/framework`를 최신 버전(`1.2.0`)으로 업데이트하자, 이번에는 `react-native@0.72.6` 버전이 `react@18.2.0`을 요구하는 새로운 충돌이 발생했습니다.
    *   **3단계 (React Native 업그레이드):** `react-native` 버전을 `react@18.3.1`과 호환되는 `0.76.7`로 대폭 업그레이드했습니다.
    *   **4단계 (클린 설치):** 계속되는 충돌을 해결하기 위해 `node_modules`와 `package-lock.json`을 삭제 후 `npm install`을 재실행하여, 마침내 의존성 설치에 성공했습니다.

3.  **`granite` 개발/빌드 도구 에러 발생**:
    *   의존성 설치는 성공했으나, `npm run dev` 및 `npm run build` 실행 시 `Cannot read properties of undefined (reading 'commands')` 에러가 새롭게 발생했습니다.

4.  **`granite` 에러 해결 시도**:
    *   **1단계 (설정 파일 수정):** 공식 예제를 참고하여 `granite.config.ts`에 `router()` 플러그인을 추가했습니다. (효과 없음)
    *   **2단계 (개발 도구 버전 통일):** `package.json` 내에서 버전이 서로 달랐던 `@granite-js/*` 관련 모든 개발 도구들의 버전을 `0.1.26`으로 통일하고 클린 설치를 진행했으나, 여전히 동일한 에러가 발생했습니다.
    *   **3단계 (`overrides` 삭제):** `package.json`의 `overrides` 섹션이 오래된 빌드 도구(`esbuild`) 버전을 강제하는 것을 마지막 원인으로 추정하고 해당 섹션을 완전히 삭제 후 클린 설치를 진행했지만, 최종적으로 에러는 해결되지 않았습니다.
    *   **4단계 (문서 확인 및 재시도):** 공식 문서를 통해 `ait init` 명령어의 존재를 확인하고, `icon` 경로 문제 등을 테스트했으나 모두 실패했습니다.

## 최종 진단

*   **원인:** `npm install`은 성공하지만 `granite` 도구의 핵심 실행부에서 에러가 발생하는 것으로 보아, 문제는 **`@apps-in-toss/framework`의 내부 버그 또는 문서화되지 않은 변경 사항**일 가능성이 매우 높습니다.
*   **다음 할 일:**
    1.  오늘 정리한 `git diff` 내역과 작업 요약본을 바탕으로 '앱인토스' 공식 지원 채널에 기술 문의를 접수합니다.

## Git 변경 사항 (`git diff`)

```diff
diff --git a/granite.config.ts b/granite.config.ts
index 76ed6ab..6c5e92b 100644
--- a/granite.config.ts
+++ b/granite.config.ts
@@ -1,4 +1,5 @@
 import { appsInToss } from '@apps-in-toss/framework/plugins';
+import { router } from '@granite-js/plugin-router';
 import { defineConfig } from '@granite-js/react-native/config';
 
 export default defineConfig({
@@ -14,5 +15,6 @@ export default defineConfig(({
       },
       permissions: [],
     }),
+    router(),
   ],
 });

diff --git a/package.json b/package.json
index 2201439..b4310bc 100644
--- a/package.json
+++ b/package.json
@@ -10,26 +10,30 @@
     "clean": "powershell -NoProfile -Command \"if (Test-Path node_modules) { Remove-Item -Recurse -Force node_modules }; if (Test-Path package-lock.json) { Remove-Item -Force package-lock.json }\""
   },
   "dependencies": {
-    "@apps-in-toss/framework": "^1.1.3",
-    "@granite-js/native": "0.1.25",
+    "@apps-in-toss/framework": "^1.2.0",
+    "@emotion/react": "^11.11.4",
+    "@granite-js/native": "0.1.26",
     "@toss-design-system/react-native": "^1.2.1",
-    "react": "18.2.0",
-    "react-native": "0.72.6"
+    "@toss/tds-mobile": "^2.1.2",
+    "@toss/tds-mobile-ait": "^2.0.1",
+    "react": "18.3.1",
+    "react-dom": "18.3.1",
+    "react-native": "0.76.7"
   },
   "devDependencies": {
     "@babel/core": "7.23.9",
     "@babel/runtime": "7.18.9",
     "@eslint/js": "^9.17.0",
-    "@granite-js/mpack": "^0.1.26",
-    "@granite-js/plugin-hermes": "0.1.25",
-    "@granite-js/plugin-router": "^0.1.26",
-    "@granite-js/react-native": "^0.1.26",
+    "@granite-js/mpack": "0.1.26",
+    "@granite-js/plugin-hermes": "0.1.26",
+    "@granite-js/plugin-router": "0.1.26",
+    "@granite-js/react-native": "0.1.26",
     "@testing-library/react-native": "^12.9.0",
     "@types/babel__core": "^7.20.5",
     "@types/jest": "^29.5.14",
     "@types/node": "^22.10.2",
     "@types/react": "18.3.3",
-    "babel-preset-granite": "0.1.25",
+    "babel-preset-granite": "0.1.26",
     "eslint": "^9.17.0",
     "eslint-plugin-react": "^7.37.2",
     "jest": "^29.7.0",
@@ -40,45 +44,7 @@
     "typescript": "^5.8.3",
     "typescript-eslint": "^8.31.0"
   },
-  "overrides": {
-    "esbuild": "0.24.0",
-    "@granite-js/plugin-core": {
-      "esbuild": "0.24.0"
-    },
-    "@granite-js/plugin-micro-frontend": {
-      "esbuild": "0.24.0"
-    },
-    "@granite-js/plugin-sentry": {
-      "esbuild": "0.24.0"
-    },
-    "@granite-js/mpack": {
-      "esbuild": "0.24.0"
-    },
-    "@granite-js/plugin-hermes": {
-      "esbuild": "0.24.0"
-    },
-    "@granite-js/plugin-router": {
-      "esbuild": "0.24.0"
-    },
-    "@granite-js/react-native": {
-      "esbuild": "0.24.0"
-    },
-    "@granite-js/cli": {
-      "esbuild": "0.24.0"
-    },
-    "@apps-in-toss/plugins": {
-      "esbuild": "0.24.0"
-    },
-    "@apps-in-toss/framework": {
-      "esbuild": "0.24.0"
-    },
-    "tsup": {
-      "esbuild": "0.24.0"
-    },
-    "bundle-require": {
-      "esbuild": "0.24.0"
-    }
-  },
+  
 
   "engines": {
     "node": ">=20"
```